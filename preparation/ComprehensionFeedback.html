{{ block global_styles }}
    <link rel="stylesheet" href="{{ static 'style.css' }}">
{{ endblock }}

{{ block global_scripts }}
<script src="{{ static 'prevent_back.js' }}"></script>
{{ endblock }}

{{ block title }}
Comprehension Check Results
{{ endblock }}

{{ block content }}

<style>
.question-correct {
    background-color: #f0f8f0;
}
.question-incorrect {
    background-color: #fff5f5;
}
.answer-correct {
    color: green;
}
.answer-incorrect {
    color: red;
}
</style>

<!-- Feedback for incorrect answers -->
{% if timeout_occurred %}
<p>
You timed out on the comprehension check. Please review the answers you have already given and the correct answers below. You have <strong>{{ remaining_tries }}</strong> more {% if remaining_tries == 1 %}try{% else %}tries{% endif %} to get all answers right and proceed with the experiment.
</p>
{% else %}
<p>
You answered <strong>{{ correct_count }}</strong> out of <strong>{{ total_questions }}</strong> questions correctly.<br>
Please review the questions and correct answers below. You have <strong>{{ remaining_tries }}</strong> more {% if remaining_tries == 1 %}try{% else %}tries{% endif %} to get all answers right and proceed with the experiment.
</p>
{% endif %}

<div style="margin-bottom: 30px;">
    
    {% for question in questions %}
    <div class="{% if question.is_correct %}question-correct{% else %}question-incorrect{% endif %}" style="margin-bottom: 25px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
        <h5 style="margin-bottom: 10px;">{{ question.question }}</h5>
        
        <div style="margin-bottom: 8px;">
            <strong>Your answer:</strong> 
            <span class="{% if question.is_correct %}answer-correct{% else %}answer-incorrect{% endif %}" style="font-weight: bold;">
                {{ question.user_answer_text }}
            </span>
            {% if question.is_correct %}
                <span class="answer-correct" style="margin-left: 10px;">✓ Correct</span>
            {% else %}
                <span class="answer-incorrect" style="margin-left: 10px;">✗ Incorrect</span>
            {% endif %}
        </div>
        
        {% if not question.is_correct %}
        <div style="margin-bottom: 8px;">
            <strong>Correct answer:</strong> 
            <span class="answer-correct" style="font-weight: bold;">{{ question.correct_text }}</span>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>

<div style="text-align: center; margin-top: 30px;">
    <p>Click the next button to try the comprehension check again.</p>
</div>

{{ next_button }}

{{ endblock }}
